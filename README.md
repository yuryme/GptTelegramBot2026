# Telegram AI-ассистент (напоминалка)

Исследовательский проект Telegram-бота, где бизнес-логика обработки пользовательских запросов вынесена в LLM-ассистента. Пользователь общается естественным языком, LLM формирует структурированные команды, а приложение валидирует и исполняет их.

## Текущий статус

- Локально работает.
- Тесты: `28 passed`.
- Текущее ограничение: лимиты OpenAI.
- VPS-деплой пока не выполнен.

## Ключевой функционал

- Создание напоминаний: одиночные, множественные, цикличные.
- Просмотр списков: все, на сегодня, с фильтрами.
- Удаление напоминаний: по фильтру и последние `N`.
- Плановая отправка напоминаний фоновым планировщиком.
- LLM-only распознавание команд (без локальных «костылей» парсинга).

## Технологии

- `Python 3.12`
- `FastAPI` + `aiogram 3`
- `PostgreSQL` + `SQLAlchemy 2` + `Alembic`
- `APScheduler`
- `Pydantic v2`
- `pytest` + `pytest-asyncio`
- `Docker` / `docker compose`

## Архитектурные принципы

- `Schema-first`: LLM отдает JSON, который валидируется Pydantic-схемами.
- Изменения интерпретации фраз делаются через prompt/схемы, а не через разрастание if/else-логики.
- Время хранится в UTC, пользовательская интерпретация времени учитывает `app_timezone`.

## Важные текущие детали

- Диспетчер напоминаний: `app/services/reminder_dispatcher.py`.
- Планировщик запускается в `app/main.py` и периодически отправляет due-напоминания.
- Формат вывода списка в Telegram: `dd.mm.yyyy HH:MM` (без секунд).
- Локализация статусов в списке:
  - `pending` -> `в ожидании`
  - `done` -> `выполнено`

## Запуск локально

```bash
docker compose up -d --build
```

Проверка здоровья:

```bash
curl http://localhost:8000/healthz
```

## Документация

- План проекта: `PROJECT_PLAN.md`
- Локальный чек-лист: `docs/LOCAL_TESTING.md`
- VPS-деплой: `deploy/DEPLOY_VPS.md`
